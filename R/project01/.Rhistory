ggplot(data=sex_age, aes(x=age, y= mean_income, col= sex))+geom_line()
sex_age <- welfare %>%
filter(!is.na(income)) %>%
group_by(age, sex) %>%
summarise(mean_income = mean(income))
x = ageg,
y = mean_income,
fill = sex)) +
geom_col()+
scale_x_discrete(limits = c("초년", "중년","노년"))
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
group_by(ageg,sex) %>%
summarise(mean_income = mean(income))
ggplot(
data= sex_income,
aes(
x = ageg,
y = mean_income,
fill = sex)) +
geom_col()+
scale_x_discrete(limits = c("초년", "중년","노년"))
welfare <- welfare %>%
dplyr::mutate(ageg = ifelse(age<30,"초년",ifelse(age <= 59, "중년", "노년")))
table(welfare$ageg)
qplot(welfare$ageg)
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
group_by(ageg,sex) %>%
summarise(mean_income = mean(income))
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
dplyr::group_by(sex) %>%
dplyr::summarise(mean_income = mean(income))
sex_income
ggplot(
data = sex_income,
aes(x=sex, y=mean_income)
) + geom_col()
welfare$birth <- ifelse(welfare$birth==999, NA,welfare$birth)
table(is.na(welfare$birth))
head(sex_age)
ggplot(data=sex_age, aes(x=age, y= mean_income, col= sex))+geom_line()
## 필요패키지
library(KoNLP)
library(wordcloud)
library(stringr)
library(dplyr)
library(RColorBrewer)
library(extrafont)
useSejongDic()
# 폰트 세팅. 띄어쓰기나 대소문자에 민감하다는 점에 주의
windowsFonts(malgun=windowsFont("맑은 고딕"))      # 맑은고딕
windowsFonts(malgun=windowsFont("나눔고딕"))       # 나눔고딕
windowsFonts(malgun=windowsFont("Arial"))  # 영어폰트
windowsFonts(malgun=windowsFont("맑은 고딕"))
windowsFonts(malgun=windowsFont("배달의민족 연성")
windowsFonts(malgun=windowsFont("배달의민족 연성"))
rawokja <- read.csv('data/okja.csv', header = T)
head(rawokja)
rawokja <- read.csv('data/okja.csv', header = T)
setwd('D:/Heechul/Project/R/project01')
## 필요패키지
library(KoNLP)
library(wordcloud)
library(stringr)
library(dplyr)
library(RColorBrewer)
library(extrafont)
library(wordcloud2)
useSejongDic()
library(ggplot2)
library(xlsx)
library(write)
# 폰트 세팅. 띄어쓰기나 대소문자에 민감하다는 점에 주의
windowsFonts(malgun=windowsFont("맑은 고딕"))      # 맑은고딕
windowsFonts(malgun=windowsFont("나눔고딕"))       # 나눔고딕
windowsFonts(malgun=windowsFont("Arial"))          # 영어폰트
windowsFonts(malgun=windowsFont("배달의민족 연성"))
rawokja <- read.csv('data/okja.csv', header = T)
head(rawokja)
okja <- rawokja %>%
select(score, date, time, month, day, fee)
colnames(okja) <- c('평점', '날짜', '시간대', '월', '요일', '요금')
head(okja)
# 01. 월별에 따른 평점
month_score <- okja %>%
select(평점, 월) %>%
group_by(월) %>%
summarise(month_score_mean = mean(평점)) %>%
arrange(month_score_mean)
month_score
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'),
angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
# theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
# theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = labels(c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))) +
# theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = labels('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
# theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = paste0('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = paste0('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = paste('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월')) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0))
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(breaks = c(1:12), labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(breaks = c(1:12), labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
scale_x_continuous(labels = c('7월', '8월', '2월', '3월', '6월', '9월', '1월', '4월', '10월', '5월', '11월', '12월'))
ggplot(month_score, aes(x= reorder(월, -month_score_mean), y=month_score_mean, fill = 월)) +
geom_bar(stat = 'identity', color = 'black') +
ggtitle('월별에 따른 평균평점') +
xlab('월') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=month_score_mean - 0.2, label= paste(round(month_score_mean,1), '점')),
color='black', size=4)
head(okja)
# 02. 요일에 따른 평점
day_score <- okja %>%
select(요일, 평점) %>%
group_by(요일) %>%
summarise(day_score_mean = mean(평점))
day_score
ggplot(day_score, aes(reorder(요일, -day_score_mean), y= day_score_mean, fill= 요일)) +
geom_bar(stat = 'identity') +
ggtitle('요일에 따른 평균평점') +
xlab('요일') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(angle=90, size = 10, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_blank()) +
theme(legend.position = 'none') +
geom_text(aes(y=day_score_mean - 0.2, label= paste(round(day_score_mean,1), '점')),
color='black', size=5)
weekend_score
# 03. 주말 시간에 따른 평점
weekend_score <- okja %>%
filter(요일 %in% c('Friday', 'Saturday', 'Sunday')) %>%
select(시간대, 평점) %>%
group_by(시간대) %>%
summarise(weekend_score_mean = mean(평점))
weekend_score
ggplot(weekend_score, aes(x= 시간대, y= weekend_score_mean, fill= 시간대)) +
geom_bar(stat = 'identity') +
ggtitle('요일에 따른 평균평점') +
xlab('요일') +
ylab('평균평점') +
theme_classic() +
theme_bw(base_family = '맑은 고딕') +
theme(plot.title = element_text(size=20, color = 'red',
hjust = 0.5, vjust=0)) +
theme(axis.title.x = element_text(size = 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.title.y = element_text(size= 15, color = 'red',
hjust = 0.5, vjust = 0)) +
theme(axis.text.x = element_text(angle=0, size = 15, color='black')) +
theme(axis.text.y = element_text(angle=0, size = 10, color='black')) +
theme(legend.title = element_text(size=10)) +
scale_fill_discrete(labels = c('나이트(24:00~)', '모닝(06:00~)', '브런치(10:00~)','데이라이트(13:00~)', '프라임(16:00~)', '문라이트(22:00~)')) +
geom_text(aes(y=weekend_score_mean - 0.3, label= paste(round(weekend_score_mean,1), '점')),
color='black', size=5)
